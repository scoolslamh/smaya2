<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ูุธุงู ุชูููู ุงููุจุงูู ุงูุชุนููููุฉ</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    body {
      font-family: "Tajawal", sans-serif;
      margin: 0;
      background: #f5f7fa;
    }

    .filters {
      background: #f9fbfd;
      padding: 20px;
      margin-bottom: 20px;
      border: 1px solid #ddd;
      border-radius: 8px;
    }
    .filters h2 {
      margin-bottom: 15px;
      color: #13344f;
      text-align: center;
    }
    .filters label {
      display: block;
      margin-bottom: 15px;
      font-weight: bold;
    }
    .filters select,
    .filters input {
      width: 100%;
      padding: 8px;
      border: 1px solid #ccc;
      border-radius: 5px;
      font-size: 14px;
      box-sizing: border-box;
    }

    #evaluationForm {
      display: none;
    }

    .form-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-bottom: 20px;
    }

    .form-navigation {
      text-align: center;
      margin-top: 20px;
    }
    .form-navigation button {
      margin: 5px;
      padding: 10px 25px;
      background: #13344f;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      transition: 0.3s;
    }
    .form-navigation button:hover {
      background: #0e2233;
    }

    header, footer {
      background: #13344f;
      color: white;
      text-align: center;
      padding: 15px 0;
    }

    header img.logo {
      height: 50px;
      display: block;
      margin: 0 auto 10px;
    }

    footer {
      font-size: 14px;
    }
  </style>
  
</head>
<body>
<!-- โ ุงูููุฏุฑ ููุตูุญุงุช ุงูุฏุงุฎููุฉ -->
<header class="main-header">
  <!-- ูุณุท: ุงูุดุนุงุฑ + ุงูุนูุงููู -->
  <div class="header-center">
    <img src="logo.png" alt="ุดุนุงุฑ ุงูุดุฑูุฉ" class="logo" />
    <h1>ุดุฑูููุฉ ุณูุงูุง</h1>
    <div class="subtitle">ูุธุงู ุชูููู ุงููุจุงูู ุงูุชุนููููุฉ</div>
  </div>
</header>

<!-- โ ุดุฑูุท ุงูุชุฑุญูุจ ุชุญุช ุงูููุฏุฑ -->
<div class="welcome-bar" id="userHeader" style="display:none;">
  <span id="welcomeMsg"></span>
  <button id="logoutBtn">ุชุณุฌูู ุงูุฎุฑูุฌ</button>
</div>



  <!-- โ ุงูุชุญูู ูู ุชุณุฌูู ุงูุฏุฎูู -->
  <script>
    if (localStorage.getItem("loggedIn") !== "true") {
      window.location.href = "index.html";
    }
  </script>

  
  <main class="container">

    <!-- ูุณู ุงูููุงุชุฑ -->
    <section class="filters">
      <h2>ุงุฎุชูุงุฑ ุงููุฏุฑุณุฉ</h2>

      <label>ุงูููุทูุฉ:
        <select id="regionFilter">
          <option value="">ุงุฎุชุฑ ุงูููุทูุฉ</option>
        </select>
      </label>

      <label>ุงููุฏููุฉ:
        <select id="cityFilter" disabled>
          <option value="">ุงุฎุชุฑ ุงููุฏููุฉ</option>
        </select>
      </label>

      <label>ุงููุฏุฑุณุฉ:
        <input type="text" id="schoolSearch" placeholder="๐ ุงุจุญุซ ุนู ูุฏุฑุณุฉ">
        <select id="schoolFilter" disabled>
          <option value="">ุงุฎุชุฑ ุงููุฏุฑุณุฉ</option>
        </select>
      </label>
    </section>

    <!-- ุดุฑูุท ุงูุชูุฏู -->
    <div id="progress-bar">
      <div id="progress"></div>
    </div>

    <!-- โ ูุนูููุงุช ุขุฎุฑ ุฒูุงุฑุฉ -->
<div id="lastVisitInfo" 
     style="display:none; text-align:center; margin:15px 0; font-weight:bold; 
            color:#13344f; background:#f0f4f8; padding:15px; border-radius:8px; font-size:16px;">
</div>

<!-- โ ุจุทุงูุฉ ุงูุชูููู ุงูููู -->
<div id="schoolEvaluation" 
     style="display:none; text-align:center; margin:15px 0; font-weight:bold; 
            color:#fff; padding:20px; border-radius:8px; font-size:18px;">
</div>
    <!-- ุงูููุงุฐุฌ -->
    <form id="evaluationForm" novalidate>
      <!-- ุงููุณู ุงูุฃูู -->
      <div class="form-step active">
        <h2>ุงูุจูุงูุงุช ุงูุฃุณุงุณูุฉ</h2>
        <div class="form-grid">
          <label>ุชุงุฑูุฎ ุงูุฒูุงุฑุฉ:
            <input type="date" id="visit_date" name="visit_date" required>
          </label>
          <input type="hidden" id="visit_day" name="visit_day">
          <input type="hidden" id="visit_month" name="visit_month">
          <input type="hidden" id="visit_year" name="visit_year">

          <label>ุงููุดุฑู ุงูุฒุงุฆุฑ:
            <input type="text" name="visitor" id="visitor" readonly>
          </label>
          <label>ุงูููุทูุฉ: <input type="text" name="region" id="region" readonly></label>
          <label>ุงููุฏููุฉ: <input type="text" name="city" id="city" readonly></label>
          <label>ุงุณู ุงููุฏุฑุณุฉ: <input type="text" name="school" id="school" readonly></label>

          <label>ุงูุฑูู ุงููุฒุงุฑู: 
            <input type="text" name="code" id="code" required>
          </label>
          <label>ุงุณู ุงูุญู/ุงูุดุงุฑุน: 
            <input type="text" name="street" id="street">
          </label>
          <label>ุชุตููู ุงููุฏุฑุณุฉ: 
  <select name="category" id="category" required>
    <option value="">ุงุฎุชุฑ</option>
    <option value="ุตุบูุฑ">ุตุบูุฑ</option>
    <option value="ูุณุท">ูุณุท</option>
    <option value="ูุจูุฑ">ูุจูุฑ</option>
  </select>
</label>
          <label>ุงููุฑุญูุฉ ุงูุชุนููููุฉ: 
  <select name="stage" id="stage" required>
    <option value="">ุงุฎุชุฑ</option>
    <option value="ุงุจุชุฏุงุฆู">ุงุจุชุฏุงุฆู</option>
    <option value="ูุชูุณุท">ูุชูุณุท</option>
    <option value="ุซุงููู">ุซุงููู</option>
    <option value="ุทูููุฉ ูุจูุฑุฉ">ุทูููุฉ ูุจูุฑุฉ</option>
    <option value="ูุฌูุน">ูุฌูุน</option>
  </select>
</label>
          <label>ุงููุฑุงุญู ุงูููุญูุฉ:
             <input type="text" name="extra_stages" id="extra_stages"> 
          </label>
          
          <label>ุนุฏุฏ ุงููุตูู: 
            <input type="number" name="classes" id="classes">
          </label>
          <label>ุดุจูุฉ ุงูููุงู ุชุตู ูููุฏุฑุณุฉ:
            <select name="water" id="water">
              <option>ูุนู</option>
              <option>ูุง</option>
            </select>
          </label>
          <label>ุดุจูุฉ ุงูุตุฑู ุงูุตุญู ุชุตู ูููุฏุฑุณุฉ:
            <select name="sewage" id="sewage">
              <option>ูุนู</option>
              <option>ูุง</option>
            </select>
          </label>
          <label>ููุน ุงูุฒูุงุฑุฉ: 
  <select name="visit_type" id="visit_type" required>
    <option value="">ุงุฎุชุฑ</option>
    <option value="ุฏูุฑูุฉ">ุฏูุฑูุฉ</option>
    <option value="ุทุงุฑุฆุฉ">ุทุงุฑุฆุฉ</option>
  </select>
</label>

          </label>
          <label>ููููุฉ ุงููุจูู: 
            <select name="ownership" id="ownership" required>
              <option value="">ุงุฎุชุฑ</option>
              <option value="ุญูููู">ุญูููู</option>
              <option value="ูุณุชุฃุฌุฑ">ูุณุชุฃุฌุฑ</option>
            </select>
          </label>
        </div>
        <div class="form-navigation">
          <button type="button" class="next">ุงูุชุงูู</button>
        </div>
      </div>

      <!-- ุงููุณู ุงูุซุงูู -->
<div class="form-step">
  <h2>ุงูุตุญุฉ ูุงูุณูุงูุฉ</h2>
  <div class="form-grid">

    <!-- ูุฎุงุฑุฌ ุงูุทูุงุฑุฆ -->
    <label>ูุฎุงุฑุฌ ุงูุทูุงุฑุฆ:
      <select name="emergency_exits" required>
        <option value="">ุงุฎุชุฑ</option>
        <option value="ูุทุงุจู">ูุทุงุจู</option>
        <option value="ุบูุฑ ูุทุงุจู">ุบูุฑ ูุทุงุจู</option>
       <option value="ูุญุชุงุฌ ุตูุงูุฉ">ูุญุชุงุฌ ุตูุงูุฉ</option>
      </select>
    </label>
    <label>ุนุฏุฏ ูุฎุงุฑุฌ ุงูุทูุงุฑุฆ:
      <input type="number" name="emergency_exits_count" min="0" placeholder="0">
    </label>

    

    <!-- ุจูุฑุงุช ุฎุฑุทูู ุงูุญุฑูู -->
    <label>ุจูุฑุงุช ุฎุฑุทูู ุงูุญุฑูู:
      <select name="fire_hose_reels" required>
        <option value="">ุงุฎุชุฑ</option>
        <option value="ูุทุงุจู">ูุทุงุจู</option>
        <option value="ุบูุฑ ูุทุงุจู">ุบูุฑ ูุทุงุจู</option>
        <option value="ูุญุชุงุฌ ุตูุงูุฉ">ูุญุชุงุฌ ุตูุงูุฉ</option>
      </select>
    </label>
    <label>ุนุฏุฏ ุจูุฑุงุช ุฎุฑุทูู ุงูุญุฑูู:
      <input type="number" name="fire_hose_reels_count" min="0" placeholder="0">
    </label>

    <!-- ุทูุงูุงุช ุงูุญุฑูู -->
    <label>ุทูุงูุงุช ุงูุญุฑูู:
      <select name="fire_extinguishers" required>
        <option value="">ุงุฎุชุฑ</option>
        <option value="ูุทุงุจู">ูุทุงุจู</option>
        <option value="ุบูุฑ ูุทุงุจู">ุบูุฑ ูุทุงุจู</option>
        <option value="ูุญุชุงุฌ ุตูุงูุฉ">ูุญุชุงุฌ ุตูุงูุฉ</option>
      </select>
    </label>
    <label>ุนุฏุฏ ุทูุงูุงุช ุงูุญุฑูู:
      <input type="number" name="fire_extinguishers_count" min="0" placeholder="0">
    </label>

    

    <!-- ููุงุดู ุฅูุฐุงุฑ ุงูุญุฑูู -->
    <label>ููุงุดู ุฅูุฐุงุฑ ุงูุญุฑูู:
      <select name="smoke_detectors" required>
        <option value="">ุงุฎุชุฑ</option>
        <option value="ูุทุงุจู">ูุทุงุจู</option>
        <option value="ุบูุฑ ูุทุงุจู">ุบูุฑ ูุทุงุจู</option>
        <option value="ูุญุชุงุฌ ุตูุงูุฉ">ูุญุชุงุฌ ุตูุงูุฉ</option>
      </select>
    </label>
    <label>ุนุฏุฏ ููุงุดู ุฅูุฐุงุฑ ุงูุญุฑูู:
      <input type="number" name="smoke_detectors_count" min="0" placeholder="0">
    </label>

    <!-- ุฌุฑุณ ุงูุฅูุฐุงุฑ -->
    <label>ุฌุฑุณ ุฅูุฐุงุฑ:
      <select name="fire_alarm" required>
        <option value="">ุงุฎุชุฑ</option>
        <option value="ูุทุงุจู">ูุทุงุจู</option>
        <option value="ุบูุฑ ูุทุงุจู">ุบูุฑ ูุทุงุจู</option>
        <option value="ูุญุชุงุฌ ุตูุงูุฉ">ูุญุชุงุฌ ุตูุงูุฉ</option>
      </select>
    </label>
    <label>ุนุฏุฏ ุฃุฌุฑุงุณ ุฅูุฐุงุฑ ุงูุญุฑูู:
      <input type="number" name="fire_alarm_count" min="0" placeholder="0">
    </label>

<!-- ููุงุท ุงูุชุฌูุน -->
    <label>ููุงุท ุงูุชุฌูุน ูููุญุงุชูุง:
      <select name="assembly_points" required>
        <option value="">ุงุฎุชุฑ</option>
        <option value="ูุทุงุจู">ูุทุงุจู</option>
        <option value="ุบูุฑ ูุทุงุจู">ุบูุฑ ูุทุงุจู</option>       
      </select>
    </label>
    <label>ุนุฏุฏ ููุงุท ุงูุชุฌูุน ูููุญุงุชูุง:
      <input type="number" name="assembly_points_count" min="0" placeholder="0">
    </label>

    <!-- ุญูุงุฌุฒ ุงูุณูุงูุฉ -->
    <label>ุญูุงุฌุฒ ุงูุณูุงูุฉ:
      <select name="safety_barriers" required>
        <option value="">ุงุฎุชุฑ</option>
        <option value="ูุทุงุจู">ูุทุงุจู</option>
        <option value="ุบูุฑ ูุทุงุจู">ุบูุฑ ูุทุงุจู</option>
      </select>
    </label>

    <!-- ููุญุงุช ูุฎุงุฑุฌ ุงูุทูุงุฑุฆ -->
    <label>ููุญุงุช ูุฎุงุฑุฌ ุงูุทูุงุฑุฆ:
      <select name="exit_signs" required>
        <option value="">ุงุฎุชุฑ</option>
        <option value="ูุทุงุจู">ูุทุงุจู</option>
        <option value="ุบูุฑ ูุทุงุจู">ุบูุฑ ูุทุงุจู</option>
        <option value="ูุญุชุงุฌ ุตูุงูุฉ">ูุญุชุงุฌ ุตูุงูุฉ</option>
      </select>
    </label>
<label>ูุณุงูู ุงููุฑูุจ:
  <select name="escape_routes" id="escape_routes" required>
    <option value="">ุงุฎุชุฑ</option>
    <option value="ูุทุงุจู">ูุทุงุจู</option>
    <option value="ุบูุฑ ูุทุงุจู">ุบูุฑ ูุทุงุจู</option>
  </select>
</label>
    <!-- ุตูุงุฏูู ุงูุฅุณุนุงูุงุช ุงูุฃูููุฉ -->
    <label>ุตูุงุฏูู ุงูุฅุณุนุงูุงุช ุงูุฃูููุฉ:
      <select name="first_aid" required>
        <option value="">ุงุฎุชุฑ</option>
        <option value="ูุทุงุจู">ูุทุงุจู</option>
        <option value="ุบูุฑ ูุทุงุจู">ุบูุฑ ูุทุงุจู</option>
        
      </select>
    </label>

    

    <!-- ุณุฌู ุงููุฎุงุทุฑ  -->
    <label>ุณุฌู ุงููุฎุงุทุฑ :
      <select name="edges" required>
        <option value="">ุงุฎุชุฑ</option>
        <option value="ูุทุงุจู">ูุทุงุจู</option>
        <option value="ุบูุฑ ูุทุงุจู">ุบูุฑ ูุทุงุจู</option>
      </select>
    </label>

    <!-- ูุซุงุฆู ุงูุณูุงูุฉ -->
    <label>ูุซุงุฆู ุงูุณูุงูุฉ:
      <select name="safety_docs" required>
        <option value="">ุงุฎุชุฑ</option>
        <option value="ูุทุงุจู">ูุทุงุจู</option>
        <option value="ุบูุฑ ูุทุงุจู">ุบูุฑ ูุทุงุจู</option>
      
      </select>
    </label>

<!-- ููุญุฉ ุชุญูู -->
    <label>ููุญุฉ ุชุญูู:
      <select name="control_panel" required>
        <option value="">ุงุฎุชุฑ</option>
        <option value="ูุทุงุจู">ูุทุงุจู</option>
        <option value="ุบูุฑ ูุทุงุจู">ุบูุฑ ูุทุงุจู</option>
        <option value="ูุญุชุงุฌ ุตูุงูุฉ">ูุญุชุงุฌ ุตูุงูุฉ</option>
      </select>
    </label>

<!-- ูุถุฎุงุช ุงูุญุฑูู -->
    <label>ูุถุฎุงุช ุงูุญุฑูู:
      <select name="fire_pumps" required>
        <option value="">ุงุฎุชุฑ</option>
        <option value="ูุทุงุจู">ูุทุงุจู</option>
        <option value="ุบูุฑ ูุทุงุจู">ุบูุฑ ูุทุงุจู</option>
        <option value="ูุญุชุงุฌ ุตูุงูุฉ">ูุญุชุงุฌ ุตูุงูุฉ</option>
      </select>
    </label>

    <!-- ูุตูุฉ ุงูุฏูุงุน ุงููุฏูู -->
    <label>ูุตูุฉ ุงูุฏูุงุน ุงููุฏูู:
      <select name="civil_defense" required>
        <option value="">ุงุฎุชุฑ</option>
        <option value="ูุทุงุจู">ูุทุงุจู</option>
        <option value="ุบูุฑ ูุทุงุจู">ุบูุฑ ูุทุงุจู</option>
        <option value="ูุญุชุงุฌ ุตูุงูุฉ">ูุญุชุงุฌ ุตูุงูุฉ</option>
      </select>
    </label>

    <!-- ุงูุจูุงุจ -->
    <label>ุงูุจูุงุจ:
      <select name="keys" required>
        <option value="">ุงุฎุชุฑ</option>
        <option value="ูุฑุถู">ูุฑุถู</option>
        <option value="ุบูุฑ ูุฑุถู">ุบูุฑ ูุฑุถู</option>
        </select>
    </label>

  </div>

  <div class="form-navigation">
    <button type="button" class="prev">ุงูุณุงุจู</button>
    <button type="button" class="next">ุงูุชุงูู</button>
  </div>
</div>


     <!-- ุงููุณู ุงูุซุงูุซ -->
<div class="form-step">
  <h2>ุงูุนูุงุตุฑ ุงููุฏููุฉ</h2>
  <div class="form-grid">

    <label>ุญุงูุฉ ุงูุญูุงุฆุท:
      <select name="walls_condition" required>
        <option value="">ุงุฎุชุฑ</option>
        <option value="ูุทุงุจู">ูุทุงุจู</option>
        <option value="ุบูุฑ ูุทุงุจู">ุบูุฑ ูุทุงุจู</option>
        <option value="ูุญุชุงุฌ ุตูุงูุฉ">ูุญุชุงุฌ ุตูุงูุฉ</option>
      </select>
    </label>

    <label>ุงูุณูุงูู ูุนูุงุตุฑูุง:
      <select name="stairs" required>
        <option value="">ุงุฎุชุฑ</option>
        <option value="ูุทุงุจู">ูุทุงุจู</option>
        <option value="ุบูุฑ ูุทุงุจู">ุบูุฑ ูุทุงุจู</option>
        <option value="ูุญุชุงุฌ ุตูุงูุฉ">ูุญุชุงุฌ ุตูุงูุฉ</option>
      </select>
    </label>

    <label>ุงูููุงูุฐ:
      <select name="windows" required>
        <option value="">ุงุฎุชุฑ</option>
        <option value="ูุทุงุจู">ูุทุงุจู</option>
        <option value="ุบูุฑ ูุทุงุจู">ุบูุฑ ูุทุงุจู</option>
        <option value="ูุญุชุงุฌ ุตูุงูุฉ">ูุญุชุงุฌ ุตูุงูุฉ</option>
      </select>
    </label>

    <label>ุงูุฃุจูุงุจ:
      <select name="doors" required>
        <option value="">ุงุฎุชุฑ</option>
        <option value="ูุทุงุจู">ูุทุงุจู</option>
        <option value="ุบูุฑ ูุทุงุจู">ุบูุฑ ูุทุงุจู</option>
        <option value="ูุญุชุงุฌ ุตูุงูุฉ">ูุญุชุงุฌ ุตูุงูุฉ</option>
      </select>
    </label>

    <label>ุญุงูุฉ ุงูุฃุฑุถูุงุช:
      <select name="floors_condition" required>
        <option value="">ุงุฎุชุฑ</option>
        <option value="ูุทุงุจู">ูุทุงุจู</option>
        <option value="ุบูุฑ ูุทุงุจู">ุบูุฑ ูุทุงุจู</option>
        <option value="ูุญุชุงุฌ ุตูุงูุฉ">ูุญุชุงุฌ ุตูุงูุฉ</option>
      </select>
    </label>

    <label>ุงูููุงูุฑ:
      <select name="light_wells" required>
        <option value="">ุงุฎุชุฑ</option>
        <option value="ูุทุงุจู">ูุทุงุจู</option>
        <option value="ุบูุฑ ูุทุงุจู">ุบูุฑ ูุทุงุจู</option>
        <option value="ูุญุชุงุฌ ุตูุงูุฉ">ูุญุชุงุฌ ุตูุงูุฉ</option>
      </select>
    </label>

    <label>ุนุฒู ุงูุณุทุญ:
      <select name="roof_insulation" required>
        <option value="">ุงุฎุชุฑ</option>
        <option value="ูุทุงุจู">ูุทุงุจู</option>
        <option value="ุบูุฑ ูุทุงุจู">ุบูุฑ ูุทุงุจู</option>
        <option value="ูุญุชุงุฌ ุตูุงูุฉ">ูุญุชุงุฌ ุตูุงูุฉ</option>
      </select>
    </label>

    <label>ุชุตุฑูู ุงูุณุทุญ:
      <select name="roof_drainage" required>
        <option value="">ุงุฎุชุฑ</option>
        <option value="ูุทุงุจู">ูุทุงุจู</option>
        <option value="ุบูุฑ ูุทุงุจู">ุบูุฑ ูุทุงุจู</option>
        <option value="ูุญุชุงุฌ ุตูุงูุฉ">ูุญุชุงุฌ ุตูุงูุฉ</option>
      </select>
    </label>

    <label>ุฅุทุงุฑ ุงูุณุทุญ (ุงูุณุชุฑุฉ):
      <select name="roof_frame" required>
        <option value="">ุงุฎุชุฑ</option>
        <option value="ูุทุงุจู">ูุทุงุจู</option>
        <option value="ุบูุฑ ูุทุงุจู">ุบูุฑ ูุทุงุจู</option>
        <option value="ูุญุชุงุฌ ุตูุงูุฉ">ูุญุชุงุฌ ุตูุงูุฉ</option>
      </select>
    </label>

    <label>ููุญุฏุฑ ุฐูู ุงูุงุญุชูุงุฌุงุช ุงูุฎุงุตุฉ:
      <select name="accessibility_ramp" required>
        <option value="">ุงุฎุชุฑ</option>
        <option value="ูุทุงุจู">ูุทุงุจู</option>
        <option value="ุบูุฑ ูุทุงุจู">ุบูุฑ ูุทุงุจู</option>
        <option value="ูุญุชุงุฌ ุตูุงูุฉ">ูุญุชุงุฌ ุตูุงูุฉ</option>
      </select>
    </label>

    <label>ุงูุญุงูุฉ ุงูุนุงูุฉ ููููุงุทู ุงูุฎุงุฑุฌูุฉ ูุงูุทุฑู:
      <select name="external_condition" required>
        <option value="">ุงุฎุชุฑ</option>
        <option value="ูุทุงุจู">ูุทุงุจู</option>
        <option value="ุบูุฑ ูุทุงุจู">ุบูุฑ ูุทุงุจู</option>
        <option value="ูุญุชุงุฌ ุตูุงูุฉ">ูุญุชุงุฌ ุตูุงูุฉ</option>
      </select>
    </label>

    <label>ุงูุจูุงุจุงุช ุงูุฑุฆูุณูุฉ:
      <select name="main_gates" required>
        <option value="">ุงุฎุชุฑ</option>
        <option value="ูุทุงุจู">ูุทุงุจู</option>
        <option value="ุบูุฑ ูุทุงุจู">ุบูุฑ ูุทุงุจู</option>
        <option value="ูุญุชุงุฌ ุตูุงูุฉ">ูุญุชุงุฌ ุตูุงูุฉ</option>
      </select>
    </label>

    <label>ุงูุณูุฑ:
      <select name="fence" required>
        <option value="">ุงุฎุชุฑ</option>
        <option value="ูุทุงุจู">ูุทุงุจู</option>
        <option value="ุบูุฑ ูุทุงุจู">ุบูุฑ ูุทุงุจู</option>
        <option value="ูุญุชุงุฌ ุตูุงูุฉ">ูุญุชุงุฌ ุตูุงูุฉ</option>
      </select>
    </label>

    <label>ุงูุนูุงุตุฑ ุงููููุงููููุฉ:
      <select name="mechanical" required>
        <option value="">ุงุฎุชุฑ</option>
        <option value="ูุทุงุจู">ูุทุงุจู</option>
        <option value="ุบูุฑ ูุทุงุจู">ุบูุฑ ูุทุงุจู</option>
        <option value="ูุญุชุงุฌ ุตูุงูุฉ">ูุญุชุงุฌ ุตูุงูุฉ</option>
      </select>
    </label>

    <label>ููุญุฉ ุงูุชูุฒูุน:
      <select name="distribution" required>
        <option value="">ุงุฎุชุฑ</option>
        <option value="ูุทุงุจู">ูุทุงุจู</option>
        <option value="ุบูุฑ ูุทุงุจู">ุบูุฑ ูุทุงุจู</option>
        <option value="ูุญุชุงุฌ ุตูุงูุฉ">ูุญุชุงุฌ ุตูุงูุฉ</option>
      </select>
    </label>

    <label>ูุธุงู ุงูุชุฃุฑูุถ:
      <select name="earthing" required>
        <option value="">ุงุฎุชุฑ</option>
        <option value="ูุทุงุจู">ูุทุงุจู</option>
        <option value="ุบูุฑ ูุทุงุจู">ุบูุฑ ูุทุงุจู</option>
        <option value="ูุญุชุงุฌ ุตูุงูุฉ">ูุญุชุงุฌ ุตูุงูุฉ</option>
      </select>
    </label>

    <label>ุฃูุธูุฉ ุงูุณูุงุนุงุช ูุงูุตูุช:
      <select name="sound" required>
        <option value="">ุงุฎุชุฑ</option>
        <option value="ูุทุงุจู">ูุทุงุจู</option>
        <option value="ุบูุฑ ูุทุงุจู">ุบูุฑ ูุทุงุจู</option>
        <option value="ูุญุชุงุฌ ุตูุงูุฉ">ูุญุชุงุฌ ุตูุงูุฉ</option>
      </select>
    </label>

    <label>ุญุงูุฉ ุงูุฅุถุงุกุฉ ุงูุนุงูุฉ:
      <select name="lighting" required>
        <option value="">ุงุฎุชุฑ</option>
        <option value="ูุทุงุจู">ูุทุงุจู</option>
        <option value="ุบูุฑ ูุทุงุจู">ุบูุฑ ูุทุงุจู</option>
        <option value="ูุญุชุงุฌ ุตูุงูุฉ">ูุญุชุงุฌ ุตูุงูุฉ</option>
      </select>
    </label>

    <label>ุฅุถุงุกุฉ ุงูุทูุงุฑุฆ:
      <select name="emergency_lighting" required>
        <option value="">ุงุฎุชุฑ</option>
        <option value="ูุทุงุจู">ูุทุงุจู</option>
        <option value="ุบูุฑ ูุทุงุจู">ุบูุฑ ูุทุงุจู</option>
        <option value="ูุญุชุงุฌ ุตูุงูุฉ">ูุญุชุงุฌ ุตูุงูุฉ</option>
      </select>
    </label>

    <label>ุงูููุงุจุณ ููููุงุช ุงูุชูุฏูุฏ:
      <select name="sockets" required>
        <option value="">ุงุฎุชุฑ</option>
        <option value="ูุทุงุจู">ูุทุงุจู</option>
        <option value="ุบูุฑ ูุทุงุจู">ุบูุฑ ูุทุงุจู</option>
        <option value="ูุญุชุงุฌ ุตูุงูุฉ">ูุญุชุงุฌ ุตูุงูุฉ</option>
      </select>
    </label>

    <label>ููููุงุช ุงูููุงุก:
      <select name="ac" required>
        <option value="">ุงุฎุชุฑ</option>
        <option value="ูุทุงุจู">ูุทุงุจู</option>
        <option value="ุบูุฑ ูุทุงุจู">ุบูุฑ ูุทุงุจู</option>
        <option value="ูุญุชุงุฌ ุตูุงูุฉ">ูุญุชุงุฌ ุตูุงูุฉ</option>
      </select>
    </label>

    <label>ูุถุฎุงุช ุงูููุงู:
      <select name="pumps" required>
        <option value="">ุงุฎุชุฑ</option>
        <option value="ูุทุงุจู">ูุทุงุจู</option>
        <option value="ุบูุฑ ูุทุงุจู">ุบูุฑ ูุทุงุจู</option>
        <option value="ูุญุชุงุฌ ุตูุงูุฉ">ูุญุชุงุฌ ุตูุงูุฉ</option>
      </select>
    </label>

    <label>ูุฑุงูุญ ุงูุดูุท:
      <select name="fans" required>
        <option value="">ุงุฎุชุฑ</option>
        <option value="ูุทุงุจู">ูุทุงุจู</option>
        <option value="ุบูุฑ ูุทุงุจู">ุบูุฑ ูุทุงุจู</option>
        <option value="ูุญุชุงุฌ ุตูุงูุฉ">ูุญุชุงุฌ ุตูุงูุฉ</option>
      </select>
    </label>

    <label>ุงููุตุงุนุฏ:
      <select name="elevators" required>
        <option value="">ุงุฎุชุฑ</option>
        <option value="ูุชููุฑ">ูุชููุฑ</option>
        <option value="ุบูุฑ ูุชููุฑ">ุบูุฑ ูุชููุฑ</option>
        <option value="ูุญุชุงุฌ ุตูุงูุฉ">ูุญุชุงุฌ ุตูุงูุฉ</option>
      </select>
    </label>

    <label>ุณุฎุงูุงุช ุงูููุงู:
      <select name="heaters" required>
        <option value="">ุงุฎุชุฑ</option>
        <option value="ูุทุงุจู">ูุทุงุจู</option>
        <option value="ุบูุฑ ูุทุงุจู">ุบูุฑ ูุทุงุจู</option>
        <option value="ูุญุชุงุฌ ุตูุงูุฉ">ูุญุชุงุฌ ุตูุงูุฉ</option>
      </select>
    </label>

    <label>ุฎุฒุงูุงุช ุงูููุงู ุงูุฃุฑุถูุฉ:
      <select name="tank_ground" required>
        <option value="">ุงุฎุชุฑ</option>
        <option value="ูุทุงุจู">ูุทุงุจู</option>
        <option value="ุบูุฑ ูุทุงุจู">ุบูุฑ ูุทุงุจู</option>
        <option value="ูุญุชุงุฌ ุตูุงูุฉ">ูุญุชุงุฌ ุตูุงูุฉ</option>
      </select>
    </label>

    <label>ุฎุฒุงูุงุช ุงูููุงู ุงูุนูููุฉ:
      <select name="tank_top" required>
        <option value="">ุงุฎุชุฑ</option>
        <option value="ูุทุงุจู">ูุทุงุจู</option>
        <option value="ุบูุฑ ูุทุงุจู">ุบูุฑ ูุทุงุจู</option>
        <option value="ูุญุชุงุฌ ุตูุงูุฉ">ูุญุชุงุฌ ุตูุงูุฉ</option>
      </select>
    </label>

    <label>ุงูุญูุงุฌุฒ ูุงูุงุถุงูุงุช ุงูุนุดูุงุฆูุฉ:
  <select name="barriers" required>
    <option value="">ุงุฎุชุฑ</option>
    <option value="ููุฌุฏ">ููุฌุฏ</option>
    <option value="ูุง ููุฌุฏ">ูุง ููุฌุฏ</option>
  </select>
</label>

        <label>ุงูุชูุตููุงุช ุงูููุฑุจุงุฆูุฉ ุงูุนุดูุงุฆูุฉ:
      <select name="wiring" required>
        <option value="">ุงุฎุชุฑ</option>
        <option value="ููุฌุฏ">ููุฌุฏ</option>
    <option value="ูุง ููุฌุฏ">ูุง ููุฌุฏ</option>
      </select>
    </label>

  </div>

  <div class="form-navigation">
    <button type="button" class="prev">ุงูุณุงุจู</button>
    <button type="submit">ุฅุฑุณุงู</button>
  </div>
</div>
</form>


    <!-- โ ุตูุฏูู ุฑุณุงุฆู ุงูุชูุจูู -->
    <div id="formMessage" 
         style="display:none; 
                color:red; 
                font-weight:bold; 
                text-align:center; 
                margin:15px 0;">
    </div>

    <!-- ุฃุฒุฑุงุฑ ุฅุถุงููุฉ -->
    <div class="form-navigation">
  <button type="button" id="newEntryBtn">๐ ุฅุฏุฎุงู ุฌุฏูุฏ</button>
</div>
  </main>
 <!-- โ ูุงูุฐุฉ ููุจุซูุฉ ูุงุณุชุนุฑุงุถ ุงูุฒูุงุฑุงุช ุงูุณุงุจูุฉ -->
<div id="visitsModal" style="display:none;
    position:fixed; top:0; left:0; width:100%; height:100%;
    background:rgba(0,0,0,0.5); z-index:1000;
    justify-content:center; align-items:center;">

  <div style="background:#fff; padding:20px; border-radius:10px;
              max-width:600px; width:90%; max-height:80%; overflow:auto;">

    <h3 style="margin-top:0; color:#13344f;">๐ ุงูุฒูุงุฑุงุช ุงูุณุงุจูุฉ</h3>
    <ul id="visitsList" style="list-style:none; padding:0;"></ul>

    <button onclick="closeVisitsModal()" 
            style="margin-top:15px; padding:8px 15px;
                   background:#13344f; color:white;
                   border:none; border-radius:5px; cursor:pointer;">
      ุฅุบูุงู
    </button>
  </div>
</div>

  <!-- ุงูููุชุฑ -->
  <footer class="main-footer">
    <p>ุฌููุน ุงูุญููู ูุญููุธุฉ ูุดุฑูุฉ ุณูุงูุง ยฉ 2025</p>
  </footer>

  <script>
    let data = []; // ูุฎุฒู ุจูุงูุงุช ุงููุฏุงุฑุณ ููุง
    const API_URL = "/.netlify/functions/api";

    // ุงุณุชุฎุฑุงุฌ ุงูููู/ุงูุดูุฑ/ุงูุณูุฉ ูู ุงูุชุงุฑูุฎ
    document.getElementById("visit_date").addEventListener("change", function() {
      const date = new Date(this.value);
      const days = ["ุงูุฃุญุฏ","ุงูุฅุซููู","ุงูุซูุงุซุงุก","ุงูุฃุฑุจุนุงุก","ุงูุฎููุณ","ุงูุฌูุนุฉ","ุงูุณุจุช"];
      document.getElementById("visit_day").value = days[date.getDay()];
      document.getElementById("visit_month").value = (date.getMonth() + 1).toString().padStart(2, "0");
      document.getElementById("visit_year").value = date.getFullYear();
    });

    document.addEventListener("DOMContentLoaded", async () => {
      document.getElementById("visitor").value = localStorage.getItem("fullName") || "ูุดุฑู";

      // โ ุนุฑุถ ุฑุณุงูุฉ ุงูุชุฑุญูุจ ุจุงูุงุณู ูุงูุฏูุฑ ููุท ุนูุฏ ุชุณุฌูู ุงูุฏุฎูู
      const isLoggedIn = localStorage.getItem("loggedIn") === "true";
      const role = localStorage.getItem("role") || "ุงููุดุฑู";
      const fullName = localStorage.getItem("fullName") || "ูุณุชุฎุฏู";
      const welcomeMsg = document.getElementById("welcomeMsg");
      const userHeader = document.getElementById("userHeader");
      const logoutBtn = document.getElementById("logoutBtn");

      if (isLoggedIn) {
        if (welcomeMsg) welcomeMsg.textContent = `๐ ูุฑุญุจุงูุ ${role}: ${fullName}`;
        if (userHeader) userHeader.style.display = "block";
      } else {
        if (userHeader) userHeader.style.display = "none";
      }

      if (logoutBtn) {
        logoutBtn.addEventListener("click", () => {
          localStorage.clear();
          window.location.href = "index.html";
        });
      }

      document.getElementById("newEntryBtn").addEventListener("click", () => {
  // โ ุฅุนุงุฏุฉ ุชุนููู ุงูููุงุชุฑ
  document.getElementById("regionFilter").value = "";
  document.getElementById("cityFilter").innerHTML = '<option value="">ุงุฎุชุฑ ุงููุฏููุฉ</option>';
  document.getElementById("cityFilter").disabled = true;
  document.getElementById("schoolFilter").innerHTML = '<option value="">ุงุฎุชุฑ ุงููุฏุฑุณุฉ</option>';
  document.getElementById("schoolFilter").disabled = true;

  // โ ุฅุนุงุฏุฉ ุชุนููู ุงููููุฐุฌ
  const formEl = document.getElementById("evaluationForm");
  if (formEl) {
    formEl.reset();                 
    formEl.style.display = "none";  // ูุฎููู ูุญุฏ ูุง ูุฎุชุงุฑ ูุฏุฑุณุฉ ูู ุฌุฏูุฏ
  }

  // โ ุฅุฎูุงุก ุฃู ุฑุณุงุฆู ุณุงุจูุฉ
  const messageBox = document.getElementById("formMessage");
  if (messageBox) {
    messageBox.style.display = "none";
    messageBox.textContent = "";
        }
      });

      // โ ุฌูุจ ุจูุงูุงุช ุงููุฏุงุฑุณ
      try {
        const res = await fetch(API_URL);
        data = await res.json(); 

        const regionSelect = document.getElementById("regionFilter");
        const citySelect = document.getElementById("cityFilter");
        const schoolSelect = document.getElementById("schoolFilter");

        // ุชุนุจุฆุฉ ุงูููุงุทู
        const regions = [...new Set(data.map(s => s.region))];
        regions.forEach(r => {
          const opt = document.createElement("option");
          opt.value = r;
          opt.textContent = r;
          regionSelect.appendChild(opt);
        });

        // ุนูุฏ ุงุฎุชูุงุฑ ููุทูุฉ
        regionSelect.addEventListener("change", () => {
          const cities = [...new Set(data.filter(s => s.region === regionSelect.value).map(s => s.city))];
          citySelect.innerHTML = "<option value=''>ุงุฎุชุฑ ุงููุฏููุฉ</option>";
          citySelect.disabled = false;
          cities.forEach(c => {
            const opt = document.createElement("option");
            opt.value = c;
            opt.textContent = c;
            citySelect.appendChild(opt);
          });
        });

        // โ ุนูุฏ ุงุฎุชูุงุฑ ูุฏููุฉ
        citySelect.addEventListener("change", () => {
          const schools = data.filter(s => s.city === citySelect.value);
          schoolSelect.innerHTML = "<option value=''>ุงุฎุชุฑ ุงููุฏุฑุณุฉ</option>";
          schoolSelect.disabled = false;
          schools.forEach(s => {
            const opt = document.createElement("option");
            opt.value = s.school;
            opt.textContent = s.school;
            schoolSelect.appendChild(opt);
          });
        });

        // โ ุงูุจุญุซ ุนู ูุฏุฑุณุฉ
        document.getElementById("schoolSearch").addEventListener("input", (e) => {
          const searchTerm = e.target.value.trim().toLowerCase();
          const filteredSchools = data.filter(s => {
            const matchCity = !citySelect.value || s.city === citySelect.value;
            const matchRegion = !regionSelect.value || s.region === regionSelect.value;
            const matchName = s.school.toLowerCase().includes(searchTerm);
            return matchCity && matchRegion && matchName;
          });

          schoolSelect.innerHTML = "<option value=''>ุงุฎุชุฑ ุงููุฏุฑุณุฉ</option>";
          schoolSelect.disabled = false;
          filteredSchools.forEach(s => {
            const opt = document.createElement("option");
            opt.value = s.school;
            opt.textContent = s.school;
            schoolSelect.appendChild(opt);
          });
        });

        // โ ุนูุฏ ุงุฎุชูุงุฑ ูุฏุฑุณุฉ
        schoolSelect.addEventListener("change", () => {
          const selectedSchool = schoolSelect.value;
          const schoolInfo = data.find(s => s.school === selectedSchool);

          if (schoolInfo) {
            document.getElementById("region").value = schoolInfo.region;
            document.getElementById("city").value = schoolInfo.city;
            document.getElementById("school").value = schoolInfo.school;
            document.getElementById("code").value = schoolInfo.code;
             // ๐ข   ุงูุณุทุฑ ุงูุชุงูู ููุญุต ุงูุจูุงูุงุช
    console.log("schoolInfo:", schoolInfo);
           // โ ุฅุธูุงุฑ ุขุฎุฑ ุฒูุงุฑุฉ ูุนุฏุฏ ุงูุฒูุงุฑุงุช
const infoBox = document.getElementById("lastVisitInfo");
let formattedDate = "ูุง ููุฌุฏ";
if (schoolInfo.last_visit) {
  const visitDate = new Date(schoolInfo.last_visit);
  formattedDate = visitDate.toLocaleDateString("ar-EG", {
    weekday: "long",
    day: "numeric",
    month: "long",
    year: "numeric"
  });
}

// โ ุฅุถุงูุฉ ุงููุต + ุฒุฑ ุงูุงุณุชุนุฑุงุถ
infoBox.innerHTML = `
  ๐๏ธ ุขุฎุฑ ุฒูุงุฑุฉ: <b>${formattedDate}</b> |
  ๐ข ุนุฏุฏ ุงูุฒูุงุฑุงุช: <b>${schoolInfo.visits || 0}</b>
  <br>
  <button id="viewVisitsBtn"
          style="margin-top:10px; padding:8px 15px;
                 background:#007BFF; color:white;
                 border:none; border-radius:5px; cursor:pointer;">
    ุงุณุชุนุฑุงุถ ุงูุฒูุงุฑุงุช ุงูุณุงุจูุฉ
  </button>
`;
infoBox.style.display = "block";

// โ ุฌูุจ ุงูุชูููู ุงูููู ูู ุขุฎุฑ ุฒูุงุฑุฉ
(async () => {
  if (schoolInfo.last_visit && schoolInfo.visits > 0) {
    try {
      const res = await fetch(API_URL, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          action: "getVisitReport",
          school: schoolInfo.school,
          visit: schoolInfo.visits  // ๐ ุฑูู ุขุฎุฑ ุฒูุงุฑุฉ
        })
      });

      const result = await res.json();
      if (result.success && result.data) {
        const totalSum = Number(result.data.total_sum) || 0;
        const totalPercent = Number(result.data.total_percent) || 0;
        renderSchoolEvaluation(totalSum, totalPercent);
      } else {
        console.warn("โ๏ธ ูู ูุชู ุงูุนุซูุฑ ุนูู ุจูุงูุงุช ุงูุชูููู ุงูููู ูู ุงูุชูุงุฑูุฑ.");
      }
    } catch (err) {
      console.error("โ ุฎุทุฃ ูู ุฌูุจ ุงูุชูููู ุงูููู:", err);
    }
  }
})();


    // โ ุฑุจุท ุญุฏุซ ุงูุถุบุท ุนูู ุงูุฒุฑ
const viewBtn = document.getElementById("viewVisitsBtn");
if (viewBtn) {
  viewBtn.addEventListener("click", async () => {
    try {
      const res = await fetch(API_URL, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          action: "getVisits",
          school: schoolInfo.school
        })
      });

      if (!res.ok) throw new Error("ูุดู ูู ุฌูุจ ุงูุจูุงูุงุช");

      const result = await res.json();
      if (result.success && result.visits.length > 0) {
        // โ ุฅูุดุงุก ูุงูุฐุฉ ููุจุซูุฉ
        let modal = document.createElement("div");
        modal.style.position = "fixed";
        modal.style.top = "0";
        modal.style.left = "0";
        modal.style.width = "100%";
        modal.style.height = "100%";
        modal.style.background = "rgba(0,0,0,0.5)";
        modal.style.display = "flex";
        modal.style.alignItems = "center";
        modal.style.justifyContent = "center";
        modal.style.zIndex = "9999";

        // โ ุตูุฏูู ุงููุงุฆูุฉ
        let box = document.createElement("div");
        box.style.background = "white";
        box.style.padding = "20px";
        box.style.borderRadius = "10px";
        box.style.width = "400px";
        box.style.maxHeight = "70%";
        box.style.overflowY = "auto";
        box.innerHTML = `<h3>๐ ุฒูุงุฑุงุช ${schoolInfo.school}</h3><ul id="visitsList"></ul>
                         <button id="closeModal" 
                           style="margin-top:15px;padding:8px 15px;background:#dc3545;color:white;
                           border:none;border-radius:5px;cursor:pointer;">ุฅุบูุงู</button>`;

        modal.appendChild(box);
        document.body.appendChild(modal);

        // โ ุชุนุจุฆุฉ ุงููุงุฆูุฉ
const list = box.querySelector("#visitsList");
result.visits.forEach(v => {
  // ุชูุณูู ุงูุชุงุฑูุฎ ุฅูู dd-mm-yyyy
  let formattedDate = "-";
  if (v.visit_date) {
    const dateObj = new Date(v.visit_date);
    const day = ("0" + dateObj.getDate()).slice(-2);
    const month = ("0" + (dateObj.getMonth() + 1)).slice(-2);
    const year = dateObj.getFullYear();
    formattedDate = `${day}-${month}-${year}`;
  }

  const li = document.createElement("li");
  li.style.marginBottom = "8px";
  li.innerHTML = `<a href="report.html?school=${encodeURIComponent(v.school)}&visit=${v.visit_number}" target="_blank">
          ๐๏ธ ${formattedDate} - ุฒูุงุฑุฉ ุฑูู ${v.visit_number}
        </a>`;
  list.appendChild(li);
});

        // โ ุฒุฑ ุฅุบูุงู
        box.querySelector("#closeModal").addEventListener("click", () => {
          document.body.removeChild(modal);
        });

      } else {
        alert("โ๏ธ ูุง ุชูุฌุฏ ุฒูุงุฑุงุช ุณุงุจูุฉ ููุฐู ุงููุฏุฑุณุฉ");
      }
    } catch (err) {
      console.error("ุฎุทุฃ ูู ุฌูุจ ุงูุฒูุงุฑุงุช:", err);
      alert("โ ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุฌูุจ ุงูุฒูุงุฑุงุช");
    }
  });
}


    // โ ุฅุธูุงุฑ ุงููููุฐุฌ
    document.getElementById("evaluationForm").style.display = "block";
  }
});

      } catch (err) {
        console.error("ุฎุทุฃ ูู ุชุญููู ุงููุฏุงุฑุณ:", err);
        alert("โ๏ธ ูู ูุชู ุชุญููู ุจูุงูุงุช ุงููุฏุงุฑุณ ูู ุงูุดูุช");
      }
    });

    document.addEventListener("DOMContentLoaded", () => {
      const steps = document.querySelectorAll(".form-step");
      const nextBtns = document.querySelectorAll(".next");
      const prevBtns = document.querySelectorAll(".prev");
      let currentStep = 0;

      function showStep(index) {
        steps.forEach((step, i) => {
          step.style.display = i === index ? "block" : "none";
        });
      }

      nextBtns.forEach(btn => {
        btn.addEventListener("click", () => {
          if (currentStep < steps.length - 1) {
            currentStep++;
            showStep(currentStep);
          }
        });
      });

      prevBtns.forEach(btn => {
        btn.addEventListener("click", () => {
          if (currentStep > 0) {
            currentStep--;
            showStep(currentStep);
          }
        });
      });

      showStep(currentStep);
    });

   // โ ุฅุฑุณุงู ุงููููุฐุฌ ุฅูู Google Sheet
document.getElementById("evaluationForm").addEventListener("submit", async (e) => {
  e.preventDefault();

  const form = e.target;
  const messageBox = document.getElementById("formMessage");

  const requiredFields = form.querySelectorAll("[required]");
  let missing = [];
  requiredFields.forEach(field => {
    if (!field.value || field.value.trim() === "") {
      missing.push(field);
      field.style.border = "2px solid red";
    } else {
      field.style.border = "";
    }
  });

  if (missing.length > 0) {
    messageBox.textContent = "โ๏ธ ุนููู ุฅููุงู ุจุงูู ุงูุญููู ุงููุทููุจุฉ";
    messageBox.style.display = "block";
    return;
  } else {
    messageBox.style.display = "none";
  }

  const formData = new FormData(form);
  const data = {};
  formData.forEach((value, key) => {
    data[key] = value;
  });

  // โ ูุญุต ูููุฉ ูุณุงูู ุงููุฑูุจ
  console.log("๐ escape_routes:", data.escape_routes);

  try {
    const res = await fetch(API_URL, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        action: "saveEvaluation",
        ...data
      })
    });

    if (!res.ok) throw new Error("ูุดู ุงูุงุชุตุงู ุจุงูุฎุงุฏู");

    const result = await res.json();
    if (result.success) {
  alert("โ ุดูุฑุงูุ ุชู ุฅุฑุณุงู ุงูุชูุฑูุฑ ุจูุฌุงุญ!");
  // ุฅุนุงุฏุฉ ุชุญููู ุงูุตูุญุฉ ุจุนุฏ ุซุงููุชูู
  setTimeout(() => {
    window.location.reload();
  }, 2000);
} else {
  alert("โ๏ธ ูู ูุชู ุงูุฅุฑุณุงู: " + (result.message || "ุฎุทุฃ ุบูุฑ ูุนุฑูู"));
}
} catch (err) {
  console.error("ุฎุทุฃ:", err);
  alert("โ ูุดู ุงูุงุชุตุงู ุจุงูุฎุงุฏู");
}
});
// โ ุฏุงูุฉ ุนุฑุถ ุงูุชูููู ุงูููู
  function renderSchoolEvaluation(totalSum, totalPercent) {
    const box = document.getElementById("schoolEvaluation");

    let grade = "ุถุนูู";
    let bgColor = "#f44336"; // ๐ด ุฃุญูุฑ

    if (totalPercent >= 90) {
      grade = "ููุชุงุฒ"; bgColor = "#2e7d32";
    } else if (totalPercent >= 80) {
      grade = "ุฌูุฏ ุฌุฏูุง"; bgColor = "#388e3c";
    } else if (totalPercent >= 70) {
      grade = "ุฌูุฏ"; bgColor = "#fbc02d";
    }

    box.style.cssText = `
      background: ${bgColor};
      color: #fff;
      font-weight: bold;
      padding: 15px;
      margin-top: 15px;
      border-radius: 10px;
      text-align: center;
      font-size: 16px;
    `;

    // โ ุงููุญุชูู ูู ุตู ูุงุญุฏ
box.innerHTML = `
  <div style="display:flex; justify-content:space-around; align-items:center; gap:15px; flex-wrap:wrap;">
    <span>๐ <b>ุงูุชูููู ุงูููู</b></span>
    <span>๐ข ุงููุฌููุน: ${totalSum}</span>
    <span>๐ ุงููุณุจุฉ: ${totalPercent.toFixed(1)}%</span>
    <span>๐ ุงูุชูุฏูุฑ: ${grade}</span>
  </div>
`;
  }
</script>
</body>
</html>

