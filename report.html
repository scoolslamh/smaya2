<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>ØªÙ‚Ø±ÙŠØ± Ø²ÙŠØ§Ø±Ø© Ù…Ø¨Ù†Ù‰ Ù…Ø¯Ø±Ø³ÙŠ</title>
  <!-- âœ… ØªÙ†Ø³ÙŠÙ‚Ø§Øª CSS -->
   <!-- âœ… Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ Ø®Ø· Tajawal -->
  <link href="https://fonts.googleapis.com/css2?family=Tajawal&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: "Tajawal", sans-serif;
      background: #f5f7fa;
      margin: 0;
      padding: 0;
      color: #13344f;
    }

    /* âœ… Ø§Ù„Ù‡ÙŠØ¯Ø± */
    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: #13344f;
      color: #ffffff;
      padding: 10px 20px;
      border-bottom: 3px solid #0e2233;
    }
    .header .title h1 {
      margin: 0;
      font-size: 20px;
      font-weight: bold;
    }
    .header .title p {
      margin: 2px 0 0;
      font-size: 14px;
      color: #cfd8dc;
    }
    .header .logo {
      height: 45px;
      max-width: 100px;
      object-fit: contain;
    }

    /* âœ… Ø§Ù„ØªÙ‚Ø±ÙŠØ± */
    .report-container {
      background: #fff;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      margin: 20px auto;
      max-width: 1200px;
      display: none; /* Ù†Ø®ÙÙŠÙ‡ Ø­ØªÙ‰ ÙŠØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª */
    }
    .report-container h2 {
      text-align: center;
      color: #13344f;
      margin-bottom: 10px;
    }
    .section-title {
      margin: 25px 0 10px;
      padding: 10px;
      background: #13344f;
      color: #fff;
      border-radius: 6px;
      font-size: 16px;
    }

    /* âœ… ØªÙ†Ø³ÙŠÙ‚Ø§Øª Ø§Ù„Ø¬Ø¯ÙˆÙ„ */
    .report-table {
      width: 100%;
      border-collapse: collapse; /* Ø¯Ù…Ø¬ Ø§Ù„Ø­Ø¯ÙˆØ¯ */
      border: 2px solid #13344f; /* Ø¥Ø·Ø§Ø± Ø®Ø§Ø±Ø¬ÙŠ */
    }
    .report-table th, 
    .report-table td {
      border: 1px solid #999;  /* Ø­Ø¯ÙˆØ¯ Ø£ÙˆØ¶Ø­ */
      padding: 8px;
      text-align: center;      /* âœ… ØªÙˆØ³ÙŠØ· Ø£ÙÙ‚ÙŠ */
      vertical-align: middle;  /* âœ… ØªÙˆØ³ÙŠØ· Ø¹Ù…ÙˆØ¯ÙŠ */
      font-size: 14px;
    }
    .report-table th {
      background: #f0f4f8;
      color: #13344f;
      font-weight: bold;
      width: 15%;
    }
    .report-table td {
      width: 18%;
      font-weight: bold;   /* âœ… Ø§Ù„Ù‚ÙŠÙ… Ø¨Ø®Ø· Ø¨ÙˆÙ„Ø¯ */
      color: #000;
      font-size: 15px;
    }

    /* âœ… Ø²Ø± Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© */
    .print-btn {
      display: block;
      margin: 25px auto 0;
      padding: 10px 20px;
      background: #13344f;
      color: #fff;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
    .print-btn:hover {
      background: #0e2233;
    }

    /* âœ… Ø´Ø§Ø´Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ */
    .loader {
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      height: 100vh;
      color: #13344f;
      font-size: 18px;
    }
    .spinner {
      border: 6px solid #f3f3f3;
      border-top: 6px solid #13344f;
      border-radius: 50%;
      width: 50px;
      height: 50px;
      animation: spin 1s linear infinite;
      margin-bottom: 15px;
    }
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
  </style>
</head>
<body>
  <!-- âœ… Ø§Ù„Ù‡ÙŠØ¯Ø± -->
  <div class="header">
    <div class="title">
      <h1>Ø´Ø±ÙƒØ© Ø³Ù…Ø§ÙŠØ§</h1>
      <p>ØªÙ‚Ø±ÙŠØ± Ø²ÙŠØ§Ø±Ø© Ù…Ø¨Ù†Ù‰ Ù…Ø¯Ø±Ø³ÙŠ</p>
    </div>
    <img src="logo.png" alt="Ø´Ø¹Ø§Ø± Ø³Ù…Ø§ÙŠØ§" class="logo">
  </div>

  <!-- âœ… Ø´Ø§Ø´Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ -->
  <div class="loader" id="loader">
    <div class="spinner"></div>
    <div>Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªÙ‚Ø±ÙŠØ±...</div>
  </div>

  <!-- âœ… Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ØªÙ‚Ø±ÙŠØ± -->
  <div class="report-container" id="reportContainer">
    <h2>ğŸ“‘ ØªÙ‚Ø±ÙŠØ± Ø²ÙŠØ§Ø±Ø© Ø§Ù„Ù…Ø¯Ø±Ø³Ø©</h2>

    <!-- âœ… Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© -->
<div class="section-title">ğŸ“Œ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©</div>
<table class="report-table">
  <tr>
    <th>ğŸ“… Ø§Ù„ØªØ§Ø±ÙŠØ®</th><td id="visit_date"></td>
    <th>ğŸ“Œ Ø§Ù„ÙŠÙˆÙ…</th><td id="visit_day"></td>
    <th>ğŸ‘¤ Ø§Ù„Ù…Ø´Ø±Ù Ø§Ù„Ø²Ø§Ø¦Ø±</th><td id="visitor"></td>
  </tr>
  <tr>
    <th>ğŸ« Ø§Ù„Ù…Ø¯Ø±Ø³Ø©</th><td id="school"></td>
    <th>ğŸ¢ Ø§Ù„Ù…Ù†Ø·Ù‚Ø©</th><td id="region"></td>
    <th>ğŸ™ï¸ Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©</th><td id="city"></td>
  </tr>
  <tr>
    <th>ğŸ”– Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ÙˆØ²Ø§Ø±ÙŠ</th><td id="code"></td>
    <th>ğŸ“ Ø§Ù„Ø­ÙŠ / Ø§Ù„Ø´Ø§Ø±Ø¹</th><td id="street"></td>
    <th>ğŸ“Š ØªØµÙ†ÙŠÙ Ø§Ù„Ù…Ø¯Ø±Ø³Ø©</th><td id="category"></td>
  </tr>
  <tr>
    <th>ğŸ·ï¸ Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©</th><td id="stage"></td>
    <th>â• Ù…Ø±Ø§Ø­Ù„ Ù…Ù„Ø­Ù‚Ø©</th><td id="extra_stages"></td>
    <th>ğŸ« Ø¹Ø¯Ø¯ Ø§Ù„ÙØµÙˆÙ„</th><td id="classes"></td>
  </tr>
  <tr>
    <th>ğŸ’§ Ø´Ø¨ÙƒØ© Ø§Ù„Ù…ÙŠØ§Ù‡</th><td id="water"></td>
    <th>ğŸš° Ø´Ø¨ÙƒØ© Ø§Ù„ØµØ±Ù Ø§Ù„ØµØ­ÙŠ</th><td id="sewage"></td>
    <th>ğŸ“‹ Ù†ÙˆØ¹ Ø§Ù„Ø²ÙŠØ§Ø±Ø©</th><td id="access"></td>
  </tr>
  <tr>
    <th>ğŸ  Ù…Ù„ÙƒÙŠØ© Ø§Ù„Ù…Ø¨Ù†Ù‰</th><td id="ownership"></td>
    <td colspan="4"></td>
  </tr>
</table>

    <!-- âœ… Ø§Ù„ØµØ­Ø© ÙˆØ§Ù„Ø³Ù„Ø§Ù…Ø© -->
    <div class="section-title">ğŸš¨ Ø§Ù„ØµØ­Ø© ÙˆØ§Ù„Ø³Ù„Ø§Ù…Ø©</div>
    <table class="report-table">
      <tr>
        <th>ğŸšª Ù…Ø®Ø§Ø±Ø¬ Ø§Ù„Ø·ÙˆØ§Ø±Ø¦</th><td id="emergency_exits"></td>
        <th>ğŸ”¢ Ø¹Ø¯Ø¯ Ù…Ø®Ø§Ø±Ø¬ Ø§Ù„Ø·ÙˆØ§Ø±Ø¦</th><td id="emergency_exits_count"></td>
        <th>ğŸ§¯ Ø·ÙØ§ÙŠØ§Øª Ø§Ù„Ø­Ø±ÙŠÙ‚</th><td id="fire_extinguishers"></td>
      </tr>
      <tr>
        <th>ğŸ”¢ Ø¹Ø¯Ø¯ Ø§Ù„Ø·ÙØ§ÙŠØ§Øª</th><td id="fire_extinguishers_count"></td>
        <th>ğŸ§µ Ø¨ÙƒØ±Ø§Øª Ø®Ø±Ø·ÙˆÙ… Ø§Ù„Ø­Ø±ÙŠÙ‚</th><td id="fire_hose_reels"></td>
        <th>ğŸ”¢ Ø¹Ø¯Ø¯ Ø§Ù„Ø¨ÙƒØ±Ø§Øª</th><td id="fire_hose_reels_count"></td>
      </tr>
      <tr>
        <th>ğŸ“¢ Ø¬Ø±Ø³ Ø§Ù„Ø¥Ù†Ø°Ø§Ø±</th><td id="fire_alarm"></td>
        <th>ğŸ”¢ Ø¹Ø¯Ø¯ Ø£Ø¬Ø±Ø§Ø³ Ø§Ù„Ø¥Ù†Ø°Ø§Ø±</th><td id="fire_alarm_count"></td>
        <th>ğŸš¨ ÙƒÙˆØ§Ø´Ù Ø§Ù„Ø¯Ø®Ø§Ù†</th><td id="smoke_detectors"></td>
      </tr>
      <tr>
        <th>ğŸ”¢ Ø¹Ø¯Ø¯ Ø§Ù„ÙƒÙˆØ§Ø´Ù</th><td id="smoke_detectors_count"></td>
        <th>ğŸš§ Ø­ÙˆØ§Ø¬Ø² Ø§Ù„Ø³Ù„Ø§Ù…Ø©</th><td id="safety_barriers"></td>
        <th>ğŸšª Ù„ÙˆØ­Ø§Øª Ø§Ù„Ù…Ø®Ø§Ø±Ø¬</th><td id="exit_signs"></td>
      </tr>
      <tr>
        <th>â›‘ï¸ Ø¥Ø³Ø¹Ø§ÙØ§Øª Ø£ÙˆÙ„ÙŠØ©</th><td id="first_aid"></td>
        <th>ğŸ“ Ù†Ù‚Ø§Ø· Ø§Ù„ØªØ¬Ù…Ø¹</th><td id="assembly_points"></td>
        <th>ğŸ”¢ Ø¹Ø¯Ø¯ Ù†Ù‚Ø§Ø· Ø§Ù„ØªØ¬Ù…Ø¹</th><td id="assembly_points_count"></td>
      </tr>
      <tr>
        <th>ğŸ“„ ÙˆØ«Ø§Ø¦Ù‚ Ø§Ù„Ø³Ù„Ø§Ù…Ø©</th><td id="safety_docs"></td>
        <th>ğŸ“¡ ÙˆØµÙ„Ø© Ø§Ù„Ø¯ÙØ§Ø¹ Ø§Ù„Ù…Ø¯Ù†ÙŠ</th><td id="civil_defense"></td>
        <th>ğŸ‘®â€â™‚ï¸ Ø§Ù„Ø¨ÙˆÙ‘Ø§Ø¨</th><td id="keys"></td>
      </tr>
      <tr>
        <th>âš¡ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</th><td id="control_panel"></td>
        <th>ğŸ“’ Ø³Ø¬Ù„ Ø§Ù„Ù…Ø®Ø§Ø·Ø±</th><td id="edges"></td>
        <th>ğŸ’§ Ù…Ø¶Ø®Ø§Øª Ø§Ù„Ø­Ø±ÙŠÙ‚</th><td id="fire_pumps"></td>
      </tr>
      <tr>
  <th>ğŸšª Ù…Ø³Ø§Ù„Ùƒ Ø§Ù„Ù‡Ø±ÙˆØ¨</th><td id="escape_routes"></td>
</tr>
    </table>
     <!-- âœ… ØµÙ Ù…Ù„Ø®Øµ Ø§Ù„ØµØ­Ø© ÙˆØ§Ù„Ø³Ù„Ø§Ù…Ø© -->
<table class="report-table">
  <tr>
    <th>ğŸ“Š Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ØµØ­Ø© ÙˆØ§Ù„Ø³Ù„Ø§Ù…Ø©</th>
    <td id="health_sum">-</td>
    <th>Ø§Ù„Ù†Ø³Ø¨Ø© %</th>
    <td id="health_percent">-</td>
  </tr>
</table>

    <!-- âœ… Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù…Ø¯Ù†ÙŠØ© -->
    <div class="section-title">ğŸ—ï¸ Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù…Ø¯Ù†ÙŠØ©</div>
    <table class="report-table">
      <tr>
        <th>ğŸ§± Ø§Ù„Ø­ÙˆØ§Ø¦Ø·</th><td id="walls_condition"></td>
        <th>ğŸªœ Ø§Ù„Ø³Ù„Ø§Ù„Ù…</th><td id="stairs"></td>
        <th>ğŸªŸ Ø§Ù„Ù†ÙˆØ§ÙØ°</th><td id="windows"></td>
      </tr>
      <tr>
        <th>ğŸšª Ø§Ù„Ø£Ø¨ÙˆØ§Ø¨</th><td id="doors"></td>
        <th>ğŸªµ Ø§Ù„Ø£Ø±Ø¶ÙŠØ§Øª</th><td id="floors_condition"></td>
        <th>ğŸŒ¤ï¸ Ø§Ù„Ù…Ù†Ø§ÙˆØ±</th><td id="light_wells"></td>
      </tr>
      <tr>
        <th>ğŸ  Ø¹Ø²Ù„ Ø§Ù„Ø³Ø·Ø­</th><td id="roof_insulation"></td>
        <th>ğŸ’§ ØªØµØ±ÙŠÙ Ø§Ù„Ø³Ø·Ø­</th><td id="roof_drainage"></td>
        <th>ğŸ§± Ø¥Ø·Ø§Ø± Ø§Ù„Ø³Ø·Ø­</th><td id="roof_frame"></td>
      </tr>
      <tr>
        <th>â™¿ Ù…Ù†Ø­Ø¯Ø±</th><td id="accessibility_ramp"></td>
        <th>ğŸŒ³ Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠØ© ÙˆØ§Ù„Ø·Ø±Ù‚</th><td id="external_condition"></td>
        <th>ğŸšª Ø§Ù„Ø¨ÙˆØ§Ø¨Ø§Øª</th><td id="main_gates"></td>
      </tr>
      <tr>
        <th>ğŸ§± Ø§Ù„Ø³ÙˆØ±</th><td id="fence"></td>
        <th>âš™ï¸ Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù…ÙŠÙƒØ§Ù†ÙŠÙƒÙŠØ©</th><td id="mechanical"></td>
        <th>ğŸ”Œ Ù„ÙˆØ­Ø© Ø§Ù„ØªÙˆØ²ÙŠØ¹</th><td id="distribution"></td>
      </tr>
      <tr>
        <th>âš¡ Ø§Ù„ØªØ£Ø±ÙŠØ¶</th><td id="earthing"></td>
        <th>ğŸ”Š Ø£Ù†Ø¸Ù…Ø© Ø§Ù„ØµÙˆØª</th><td id="sound"></td>
        <th>ğŸ’¡ Ø§Ø­Ø§Ù„Ø© Ù„Ø¥Ø¶Ø§Ø¡Ø©</th><td id="lighting"></td>
      </tr>
      <tr>
        <th>ğŸš¨ Ø¥Ø¶Ø§Ø¡Ø© Ø§Ù„Ø·ÙˆØ§Ø±Ø¦</th><td id="emergency_lighting"></td>
        <th>ğŸ”Œ Ø§Ù„Ù…Ù‚Ø§Ø¨Ø³ ÙˆÙÙ†ÙˆØ§Øª Ø§Ù„ØªÙ…Ø¯ÙŠØ¯</th><td id="sockets"></td>
        <th>â„ï¸ Ø§Ù„Ù…ÙƒÙŠÙØ§Øª</th><td id="ac"></td>
      </tr>
      <tr>
        <th>ğŸ’§ Ù…Ø¶Ø®Ø§Øª Ø§Ù„Ù…ÙŠØ§Ù‡</th><td id="pumps"></td>
        <th>ğŸŒ¬ï¸ Ù…Ø±Ø§ÙˆØ­ Ø§Ù„Ø´ÙØ·</th><td id="fans"></td>
        <th>ğŸ›— Ø§Ù„Ù…ØµØ§Ø¹Ø¯</th><td id="elevators"></td>
      </tr>
      <tr>
        <th>ğŸ”¥ Ø³Ø®Ø§Ù†Ø§Øª Ø§Ù„Ù…ÙŠØ§Ù‡</th><td id="heaters"></td>
        <th>ğŸš° Ø®Ø²Ø§Ù† Ø£Ø±Ø¶ÙŠ</th><td id="tank_ground"></td>
        <th>ğŸš° Ø®Ø²Ø§Ù† Ø¹Ù„ÙˆÙŠ</th><td id="tank_top"></td>
      </tr>
      <tr>
        <th>ğŸš§ Ø§Ù„Ø­ÙˆØ§Ø¬Ø² ÙˆØ§Ù„Ø¹Ø´ÙˆØ§Ø¦ÙŠØ§Øª</th><td id="barriers"></td>
        <th>âš¡ ØªÙˆØµÙŠÙ„Ø§Øª ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØ© Ø¹Ø´ÙˆØ§Ø¦ÙŠØ©</th><td id="wiring"></td>
        <td colspan="2"></td>
      </tr>
    </table>
      <!-- âœ… ØµÙ†Ø¯ÙˆÙ‚ Ù…Ù„Ø®Øµ Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù…Ø¯Ù†ÙŠØ© -->
<table class="report-table summary">
  <tr>
    <th>ğŸ“Š Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ù…Ø¯Ù†ÙŠ</th>
    <td id="civil_sum">-</td>
    <th>Ø§Ù„Ù†Ø³Ø¨Ø© %</th>
    <td id="civil_percent">-</td>
  </tr>
</table>


    <!-- âœ… Ø§Ù„ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ -->
<table class="report-table summary">
  <tr>
    <th>ğŸ“Š Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙƒÙ„ÙŠ</th>
    <td id="total_sum">-</td>
    <th>Ø§Ù„Ù†Ø³Ø¨Ø© Ø§Ù„ÙƒÙ„ÙŠØ© %</th>
    <td id="total_percent">-</td>
  </tr>
</table>

    <!-- âœ… Ø­Ù‚Ù„ Ø§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯ -->
    <div class="section-title">ğŸ” Ø§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯</div>
    <table class="report-table">
      <tr>
        <th>Ø§Ù„Ø§Ø³Ù€Ù€Ù…</th>
        <td colspan="3" style="height:40px;"></td>
      </tr>
      <tr>
        <th>Ø§Ù„ØªÙˆÙ‚ÙŠØ¹</th><td style="height:60px;"></td>
        <th>Ø§Ù„Ø®ØªÙ…</th><td style="height:60px;"></td>
      </tr>
    </table>

    <button onclick="window.print()" class="print-btn">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø© / Ø­ÙØ¸ PDF</button>
  </div>

  <script>
  const API_URL = "/.netlify/functions/api"; 

  const urlParams = new URLSearchParams(window.location.search);
  const schoolName = urlParams.get("school");
  const visitNumber = urlParams.get("visit");

  async function loadReport() {
    const loader = document.getElementById("loader");
    const reportContainer = document.getElementById("reportContainer");

    try {
      loader.style.display = "flex";
      reportContainer.style.display = "none";

      const res = await fetch(API_URL, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          action: "getVisitReport",
          school: schoolName,
          visit: visitNumber
        })
      });

      const result = await res.json();
      if (result.success) {
        const report = result.data;
        for (const key in report) {
          const el = document.getElementById(key);
          if (el) {
            let value = report[key] || "-";

            // âœ… ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„ØªØ§Ø±ÙŠØ® (dd-mm-yyyy)
            if (key === "visit_date" && value && value !== "-") {
              const dateObj = new Date(value);
              const day = ("0" + dateObj.getDate()).slice(-2);
              const month = ("0" + (dateObj.getMonth() + 1)).slice(-2);
              const year = dateObj.getFullYear();
              value = `${day}-${month}-${year}`;
            }

            el.textContent = value;
          }
        }

        loader.style.display = "none";
        reportContainer.style.display = "block";

       // âœ… Ù…Ù„Ø¡ Ø§Ù„Ù…Ø¬Ø§Ù…ÙŠØ¹ ÙˆØ§Ù„Ù†Ø³Ø¨ Ù…Ø¹ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„ÙÙˆØ§ØµÙ„
function parseNumber(value) {
  if (value === null || value === undefined || value === "-") return 0;
  return parseFloat(value.toString().replace(",", "."));
}

document.getElementById("health_sum").textContent = report.health_sum || "0";
document.getElementById("civil_sum").textContent = report.civil_sum || "0";
document.getElementById("total_sum").textContent = report.total_sum || "0";

const healthValue = parseNumber(report.health_percent);
const healthPercentEl = document.getElementById("health_percent");
healthPercentEl.textContent = healthValue.toFixed(1) + "%";
setBoxColor(healthPercentEl, healthValue);

const civilValue = parseNumber(report.civil_percent);
const civilPercentEl = document.getElementById("civil_percent");
civilPercentEl.textContent = civilValue.toFixed(1) + "%";
setBoxColor(civilPercentEl, civilValue);

const totalValue = parseNumber(report.total_percent);
const totalPercentEl = document.getElementById("total_percent");
totalPercentEl.textContent = totalValue.toFixed(1) + "%";
setBoxColor(totalPercentEl, totalValue);


} else {
  loader.style.display = "none";
  showError("âš ï¸ " + (result.message || "Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„ØªÙ‚Ø±ÙŠØ±"));
}
} catch (err) {
  loader.style.display = "none";
  console.error("Ø®Ø·Ø£:", err);
  showError("âŒ ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù…");
}
}

// âœ… Ø¯Ø§Ù„Ø© Ø¥Ø¸Ù‡Ø§Ø± Ø±Ø³Ø§Ù„Ø© Ø®Ø·Ø£ Ù…Ù†Ø³Ù‚Ø© Ø¯Ø§Ø®Ù„ Ø§Ù„ØµÙØ­Ø©
function showError(message) {
  const reportContainer = document.getElementById("reportContainer");
  reportContainer.style.display = "block";
  reportContainer.innerHTML = `
    <div class="error-box" style="
      background:#f8d7da;
      color:#721c24;
      border:1px solid #f5c6cb;
      padding:15px;
      margin:20px;
      border-radius:8px;
      font-size:16px;
      text-align:center;">
      ${message}
    </div>
  `;
}

  // âœ… Ø¯Ø§Ù„Ø© Ù„ØªÙ„ÙˆÙŠÙ† Ø§Ù„ØµÙ†Ø¯ÙˆÙ‚ Ø­Ø³Ø¨ Ø§Ù„Ù†Ø³Ø¨Ø©
  function setBoxColor(element, percent) {
    if (!percent || isNaN(percent)) {
      element.style.backgroundColor = "#eee"; // Ø±Ù…Ø§Ø¯ÙŠ
      element.style.color = "#000";
      return;
    }

    if (percent >= 90) {
      element.style.backgroundColor = "#b6d7a8"; // Ø£Ø®Ø¶Ø± ÙØ§ØªØ­
      element.style.color = "#000";
    } else if (percent >= 70) {
      element.style.backgroundColor = "#ffe599"; // Ø£ØµÙØ±
      element.style.color = "#000";
    } else {
      element.style.backgroundColor = "#f4cccc"; // Ø£Ø­Ù…Ø±
      element.style.color = "#000";
    }
  }

  loadReport();
</script>
</body>
</html>
